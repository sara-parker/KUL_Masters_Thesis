---
title: "Transactions by payment method over time"
output: word_document
---

```{r include=TRUE}

library(knitr)
library(dplyr)
library(ggplot2)
library(readxl)

transactions_summary <- read_excel("/Users/saraparker/Library/CloudStorage/OneDrive-Personal/KU Leuven/MBA - Accounting/Masters Thesis/data/sample_pmt_year_graph.xlsx")

transactions_summary$Payment_Method <- factor(transactions_summary$Payment_Method, levels = c("Shares", "Mixed", "Cash"))

transactions_summary$year_of_announcement <- as.integer(transactions_summary$year_of_announcement)

transactions_summary <- transactions_summary %>%
  arrange(year_of_announcement) %>%
  group_by(year_of_announcement, Payment_Method) %>%
  summarise(Frequency = n(), .groups = 'drop')

ggplot(transactions_summary, aes(x = year_of_announcement, y = Frequency, fill = Payment_Method)) + geom_bar(stat = "identity", position = "stack", color = "black") +
scale_fill_manual(values = c("Cash" = "black", "Shares" = "grey", "Mixed" = "white")) + theme_minimal() + labs(x = "Year", y = "Frequency", fill =
"Payment Type") + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) # Rotate x axis labels if needed
```